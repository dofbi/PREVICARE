function d(t){const e=m(t),a=new ArrayBuffer(e.length),r=new DataView(a);for(let o=0;o<a.byteLength;o++)r.setUint8(o,e.charCodeAt(o));return a}const w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function m(t){t.length%4===0&&(t=t.replace(/==?$/,""));let e="",a=0,r=0;for(let o=0;o<t.length;o++)a<<=6,a|=w.indexOf(t[o]),r+=6,r===24&&(e+=String.fromCharCode((a&16711680)>>16),e+=String.fromCharCode((a&65280)>>8),e+=String.fromCharCode(a&255),a=r=0);return r===12?(a>>=4,e+=String.fromCharCode(a)):r===18&&(a>>=2,e+=String.fromCharCode((a&65280)>>8),e+=String.fromCharCode(a&255)),e}const D=-1,L=-2,U=-3,C=-4,b=-5,P=-6;function B(t,e){return F(JSON.parse(t),e)}function F(t,e){if(typeof t=="number")return o(t,!0);if(!Array.isArray(t)||t.length===0)throw new Error("Invalid input");const a=t,r=Array(a.length);function o(n,u=!1){if(n===D)return;if(n===U)return NaN;if(n===C)return 1/0;if(n===b)return-1/0;if(n===P)return-0;if(u)throw new Error("Invalid input");if(n in r)return r[n];const s=a[n];if(!s||typeof s!="object")r[n]=s;else if(Array.isArray(s))if(typeof s[0]=="string"){const i=s[0],E=e?.[i];if(E)return r[n]=E(o(s[1]));switch(i){case"Date":r[n]=new Date(s[1]);break;case"Set":const f=new Set;r[n]=f;for(let c=1;c<s.length;c+=1)f.add(o(s[c]));break;case"Map":const R=new Map;r[n]=R;for(let c=1;c<s.length;c+=2)R.set(o(s[c]),o(s[c+1]));break;case"RegExp":r[n]=new RegExp(s[1],s[2]);break;case"Object":r[n]=Object(s[1]);break;case"BigInt":r[n]=BigInt(s[1]);break;case"null":const T=Object.create(null);r[n]=T;for(let c=1;c<s.length;c+=2)T[s[c]]=o(s[c+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const c=globalThis[i],A=s[1],g=d(A),p=new c(g);r[n]=p;break}case"ArrayBuffer":{const c=s[1],A=d(c);r[n]=A;break}default:throw new Error(`Unknown type ${i}`)}}else{const i=new Array(s.length);r[n]=i;for(let E=0;E<s.length;E+=1){const f=s[E];f!==L&&(i[E]=o(f))}}else{const i={};r[n]=i;for(const E in s){const f=s[E];i[E]=o(f)}}return r[n]}return o(0)}function k(t){return t.endsWith("/")?t:t+"/"}const N={actionName:"_action"},v=N,M=k,h={BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,CONTENT_TOO_LARGE:413,URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,MISDIRECTED_REQUEST:421,UNPROCESSABLE_CONTENT:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_EARLY:425,UPGRADE_REQUIRED:426,PRECONDITION_REQUIRED:428,TOO_MANY_REQUESTS:429,REQUEST_HEADER_FIELDS_TOO_LARGE:431,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,VARIANT_ALSO_NEGOTIATES:506,INSUFFICIENT_STORAGE:507,LOOP_DETECTED:508,NETWORK_AUTHENTICATION_REQUIRED:511},Q=Object.entries(h).reduce((t,[e,a])=>({...t,[a]:e}),{});class l extends Error{type="AstroActionError";code="INTERNAL_SERVER_ERROR";status=500;constructor(e){super(e.message),this.code=e.code,this.status=l.codeToStatus(e.code),e.stack&&(this.stack=e.stack)}static codeToStatus(e){return h[e]}static statusToCode(e){return Q[e]??"INTERNAL_SERVER_ERROR"}static fromJson(e){return V(e)?new Y(e.issues):G(e)?new l(e):new l({code:"INTERNAL_SERVER_ERROR"})}}function G(t){return typeof t=="object"&&t!=null&&"type"in t&&t.type==="AstroActionError"}function V(t){return typeof t=="object"&&t!=null&&"type"in t&&t.type==="AstroActionInputError"&&"issues"in t&&Array.isArray(t.issues)}class Y extends l{type="AstroActionInputError";issues;fields;constructor(e){super({message:`Failed to validate: ${JSON.stringify(e,null,2)}`,code:"BAD_REQUEST"}),this.issues=e,this.fields={};for(const a of e)if(a.path.length>0){const r=a.path[0].toString();this.fields[r]??=[],this.fields[r]?.push(a.message)}}}function _(t){return`?${new URLSearchParams({[N.actionName]:t}).toString()}`}function y(t){if(t.type==="error"){let e;try{e=JSON.parse(t.body)}catch{return{data:void 0,error:new l({message:t.body,code:"INTERNAL_SERVER_ERROR"})}}return{error:l.fromJson(e),data:void 0}}return t.type==="empty"?{data:void 0,error:void 0}:{data:B(t.body,{URL:e=>new URL(e)}),error:void 0}}const $="%2E";function S(t={},e=""){return new Proxy(t,{get(a,r){if(r in a||typeof r=="symbol")return a[r];const o=e+encodeURIComponent(r.toString()).replaceAll(".",$);function n(u){return I(u,o)}return Object.assign(n,{queryString:_(o),toString:()=>n.queryString,$$FORM_ACTION:function(){return{method:"POST",name:"_astroAction",action:"?"+new URLSearchParams(n.toString()).toString()}},async orThrow(u){const{data:s,error:i}=await I(u,o);if(i)throw i;return s}}),S(n,o+".")}})}function j(t){let e=`${"/".replace(/\/$/,"")}/_actions/${new URLSearchParams(t.toString()).get(v.actionName)}`;return e=M(e),e}async function I(t,e,a){const r=new Headers;r.set("Accept","application/json");let o=t;if(!(o instanceof FormData)){try{o=JSON.stringify(t)}catch(u){throw new l({code:"BAD_REQUEST",message:`Failed to serialize request body to JSON. Full error: ${u.message}`})}o?r.set("Content-Type","application/json"):r.set("Content-Length","0")}const n=await fetch(j({toString(){return _(e)}}),{method:"POST",body:o,headers:r});return n.status===204?y({type:"empty",status:204}):y({type:n.ok?"data":"error",body:await n.text()})}const O=S();document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("mobile-menu-button"),e=document.getElementById("mobile-menu");t?.addEventListener("click",()=>{e?.classList.toggle("hidden")}),document.getElementById("logout-btn")?.addEventListener("click",async o=>{o.preventDefault();try{const n=await O.auth.signOut();n?.data?.success?window.location.reload():(console.error("Échec de la déconnexion:",n?.error),window.location.href="/")}catch(n){console.error("Erreur de déconnexion:",n),window.location.href="/"}}),document.getElementById("mobile-logout-btn")?.addEventListener("click",async o=>{o.preventDefault();try{const n=await O.auth.signOut();n?.data?.success?window.location.reload():(console.error("Échec de la déconnexion:",n?.error),window.location.href="/")}catch(n){console.error("Erreur de déconnexion:",n),window.location.href="/"}})});
